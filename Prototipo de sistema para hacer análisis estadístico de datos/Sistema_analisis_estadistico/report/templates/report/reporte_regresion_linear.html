{% extends "report/plantilla_reporte.html" %}

{% block reporte %}

    <div class="mb-5">
        <h3>{{ reporte.titulo }}</h3>
        <p>{{ reporte.descripcion }}</p>
    </div>


    <!-- Primeras Filas Analizadas -->
    <div class="container mt-5 mb-5">
        <h4>Muestra de datos analizados</h4>
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        {% for columna in reporte.resultados.nombres_columnas %}
                            <th>{{ columna }}</th>
                        {% endfor %}
                    </tr>
                </thead> 
                <tbody>
                    {% for fila in reporte.resultados.primeras_filas %}
                        <tr>
                            {% for valor in fila.values %}
                                <td>{{ valor }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>                
        </div>
    </div>


    <!-- Estadísticas Básicas -->
    <div class="container mt-5 mb-5">
        <h4>Estadísticas</h4>
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Estadística</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody>
                    {% for stat, value in reporte.resultados.estadisticas.items %}
                    <tr>
                        <td>{{ stat }}</td>
                        <td>{{ value }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>            
        </div>

    </div>


    <!-- Coeficientes del Modelo -->
    <div class="container mt-5 mb-5">
        <h4>Coeficientes del Modelo</h4>
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Variable</th>
                        <th>Coeficiente</th>
                    </tr>
                </thead>
                <tbody>
                    {% for variable, coef in reporte.resultados.coeficientes.items %}
                    <tr>
                        <td>{{ variable }}</td>
                        <td>{{ coef }}</td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td>Intercepto</td>
                        <td>{{ reporte.resultados.intercepto }}</td>
                    </tr>
                </tbody>
            </table>            
        </div>
    </div>

    <!-- Gráfico de Regresión Lineal -->
    {% if reporte.resultados.graficos %}
        {% for grafico in reporte.resultados.graficos %}
        <div class="container mt-5 mb-5">
            <h4>{{ grafico.titulo }}</h4>
            <canvas id="grafico{{ forloop.counter }}"></canvas>
            <script>
                var ctx = document.getElementById('grafico{{ forloop.counter }}').getContext('2d');
                var mixedChart = new Chart(ctx, {
                    type: 'scatter',
                    data: {
                        datasets: [
                            {
                                label: 'Puntos Observados',
                                data: {{ grafico.datos.puntos_observados|safe }},
                                backgroundColor: 'rgba(0, 99, 132, 0.6)',
                                showLine: false,
                            },
                            {
                                label: 'Línea de Ajuste',
                                data: {{ grafico.datos.puntos_linea_ajuste|safe }},
                                type: 'line',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 2,
                                fill: false,
                            }
                        ]
                    },
                    options: {
                        scales: {
                            xAxes: [{
                                type: 'linear',
                                position: 'bottom'
                            }]
                        }
                    }
                });
            </script>            
        </div>
        {% endfor %}
    {% endif %}

{% endblock %}

